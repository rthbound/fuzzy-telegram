<!doctype html>

<html>
  <head>
    <title>Riot todo</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <!--[if lt IE 9]>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.0.5/es5-shim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script>html5.addElements('todo')</script>
    <![endif]-->


  <todo>
    <h3>{ opts.title }</h3>

    <ul>
      <li each={ items.filter(whatShow) }>
        <label class={ completed: done }>
          <input type="checkbox" checked={ done } onclick={ parent.toggle }> { title }
        </label>
      </li>
    </ul>

    <form onsubmit={ add }>
      <input name="input" onkeyup={ edit }>
      <button disabled={ !text }>Add #{ items.filter(whatShow).length + 1 }</button>

      <button disabled={ items.filter(onlyDone).length == 0 } onclick={ removeAllDone }>
      X{ items.filter(onlyDone).length } </button>
    </form>
    <script>
      this.items = opts.items

      edit(e) {
        this.text = e.target.value
      }

      add(e) {
        if (this.text) {
          this.items.push({ title: this.text })
          this.text = this.input.value = ''
        }
      }

      removeAllDone(e) {
        this.items = this.items.filter(function(item) {
          return !item.done
        })
      }

      // an two example how to filter items on the list
      whatShow(item) {
        return !item.hidden
      }

      onlyDone(item) {
       return item.done
      }

      toggle(e) {
        var item = e.item
        item.done = !item.done
        return true
      }
    </script>
  </todo>

  </head>

  <body>
    <todo></todo>
    <script src="https://cdn.rawgit.com/riot/riot/master/riot+compiler.min.js"></script>
    <script>
    riot.mount('todo', {
      title: 'I want to behave!',
      items: [
        { title: 'Avoid excessive coffeine', done: true },
        { title: 'Hidden item',  hidden: true },
        { title: 'Be less provocative'  },
        { title: 'Be nice to people' }
      ]
    })


    </script>
  </body>
</html>
